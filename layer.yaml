includes:
  - 'layer:basic'
  - 'interface:java'
ignore:
  - 'tests/unit'
  - 'tox_unit.ini'
  - 'unit_test_requirements.txt'
options:
  basic:
    packages:
      - puppet-common
      - unzip
defines:
  install_java:
    type: string
    default: 'openjdk-8-jdk'
    description: |
      Tell this charm to install java, instead of relying on the openjdk charm.
      This string should match the name of the java package to be installed.

  bigtop_component_list:
    # XXX this should be a proper array of strings
    type: string
    default: 'hadoop'
    description: 'Space seperated list of bigtop component to be installed'

  bigtop_version:
    type: string
    default: '1.1.0'
    description: |
        Bigtop release version. Affects the location of Hiera bits, Puppet
        recipes, and repository used for installing packages.

  bigtop_release_url:
    type: string
    default: 'https://www.apache.org/dist/bigtop/bigtop-1.1.0/bigtop-1.1.0-project.tar.gz?sha1=abeb9fec87f3923948e506e37a196bc490512eba'
    description: |
        URL to the location of Bigtop source tarball v.1.1.0
        This points to the official Apache Bigtop releases on of the ASF mirrors.
        The source code is needed in order to get access to project's Puppet recipes

  bigtop_repo_url:
    type: string
    default: 'http://bigtop-repos.s3.amazonaws.com/releases/{version}/{dist}/{series}/{arch}'
    description: |
        Apache Bigtop repo URL used to install Bigtop packages. The version
        dist, series, and arch will be substituted based on the platform and
        configuration at deployment time. You may specify a URL that omits
        these special keys; they will be ignored if not present during
        substitution.

  bigtop_global_hiera:
    type: string
    default: '/etc/puppet/hiera.yaml'
    description: 'Hiera global configuration file'

  bigtop_hiera_config:
    type: string
    default: 'bigtop-deploy/puppet/hiera.yaml'
    description: 'Hiera Bigtop config file, relative to the bigtop src dir'

  bigtop_hiera_siteyaml:
    type: string
    default: 'bigtop-deploy/puppet/hieradata/site.yaml'
    description: 'Hiera Bigtop site yaml, relative to the bigotp src dir'

  bigtop_smoketest_components:
    type: array
    items: {type: string}
    description: |
        A list of Bigtop components to exercise during the
        smoke-test action. Available components can be found at:
        https://github.com/apache/bigtop/tree/master/bigtop-tests/smoke-tests

  groups:
    description: |
      A list of system groups to be created during setup.
    type: array
    items: {type: string}
  users:
    description: |
      This option defines system users to be created during setup.  The value
      for this option should be a mapping of usernames to information about
      the user.  Currently, this only supports a 'groups' item that should be
      a list of groups to add the user to, with the first being the user's
      primary group.
    type: object
    patternProperties:
      '^[a-z_][a-z0-9_-]*[$]?$':
        type: object
        additionalProperties: false
        properties:
          groups:
            type: array
            items: {type: string}
  dirs:
    description: |
      This option defines directories to be created during setup.  The value
      for this option should be a mapping of symbolic identifiers (i.e., not
      the dir path) to a mapping containing information about the directory,
      such as the path, permissions bits, owner, and group.  The path can
      contain references to other defined directories in the form
      '{dirs[<dir-id>]}', or to config option values in the form
      '{config[<opt-name>]}'.
    type: object
    patternProperties:
      '.*':
        type: object
        additionalProperties: false
        properties:
          path: {type: string}
          perms: {type: integer}
          owner: {type: string}
          group: {type: string}
  ports:
    description: |
      This option defines controlled by the service.
    type: object
    patternProperties:
      '.*':
        type: object
        additionalProperties: false
        properties:
          port: {type: integer}
          exposed_on: {type: string}
